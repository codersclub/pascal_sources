<html><head><title>10h советов программисту на TP</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<meta name="description" content='16 весьма полезных советов и трюков'>
<meta name="keywords" content="pascal, sources, source code, 10hadv, misc, Прочие Программы ">
<LINK REL=STYLESHEET TYPE="text/css" HREF="../sources.css"></head><BODY><center>

<!--#include virtual="/t_hmenu.htm"-->


<div align='left'>&nbsp;&nbsp;&nbsp;<a class='title' href="index.htm">Прочие Программы</a>&nbsp&nbsp;&nbsp;&nbsp;<small>&gt;&gt;</small>&nbsp;&nbsp;&nbsp;&nbsp;10hadv
<br>&nbsp;&nbsp;&nbsp;<img border=0 height=4 width=50% align='top' src="../img/b.gif" alt="">
<br>&nbsp;
</div>


<TABLE cellSpacing=0 cellpadding=0 width=97% border=0>

<TR class=subheader><TD colSpan=3><IMG height=2 src="../img/1x1.gif" width=1></td></tr>
<TR><TD class=subheader width=70% nowrap>&nbsp;10h советов программисту на TP</TD>
<TD nowrap class=black>&nbsp;<img border=0 align=bottom src="../img/mail.gif">&nbsp;<a href="mailto:vitus@fe.msk.ru">Виктор Вагнер</a></TD>
<TD class=black align='right'>15.09.1994</TD></TR>
<TR vALign=top><TD class=black>&#10;<p style="margin-left:20px">16 весьма полезных советов и трюков</TD><TD class=black colspan=2 align='right'><br><A HREF="10hadv.zip"><img border=0 align=middle src="../img/dsk.gif"></A><br>5k&nbsp;</TD></TR><TR><TD>&nbsp;</TD></TR>

<TR class=subheader><TD colSpan=3><IMG height=2 src="../img/1x1.gif" width=1></td></tr>
<TR><TD colspan=3><PRE><p style="margin-left:50px">From: "Victor B. Wagner" &lt;vitus@agropc.msk.su&gt;
Subj: А знаете ли вы что... (ver 2).10H советов программисту на TP
Organization: Agroecological problems Center


Около месяца назад я уже посылал первую версию этого текста в
телеконференцию. Тогда советов было 8. Сейчас их число выросло
вдвое. Но поскольку первые советы прошли в сезон летних отпусков,
я на всякий  случай повторяю и их.
    Приглашаю всех кто совершает маленькие открытия в процессе работы
с Turbo Pascal следовать моему примеру и писать о них не дожидаясь,
пока кто-нибудь отчаянно завопит: "HE-E-ELP!!!" Вдруг кому приго-
дится.

                        А знаете ли вы?

         Несколько (10h) советов программисту на Turbo Pascal

&gt;$0001
А знаете ли вы , что процедура Rename в Turbo  Pascal поз-
воляет перемещать файлы из  одного  каталога в другой (правда в
пределах одного диска)?

&gt;$0002
А знаете ли вы, что вопреки тому, что утверждается в Help,
из программы  на TP можно открыть более 16  файлов (в пределе -
столько, сколько написано в команде FILES CONFIG.SYS). Вот так:
 Procedure SetMaxFiles(Count:Word);assembler;
 asm
   Mov AH,67H
   MOV BX,Count
   Int 21H
 end;
После этого  вызываете  SetMaxFiles(40)  и  40 файлов (включая,
правда 5 стандартных) в вашем распоряжении.

&gt;$0003
А знаете ли вы, что для того, чтобы вызвать из вашей прог-
раммы другую, совершенно не обязательно задавать директиву $M и
ограничивать память  вашей  программы  еще в момент компиляции.
Имеющаяся в модуле Memory Turbo Vision процедура SetMemTop поз-
воляет отдать дочернему процессу всю свободную динамическую па-
мять. Вот так
 SetMemTop(HeapPtr);{Отдаем память}
 Exec(GetEnv('COMSPEC'),'');{В данном случае вызываем DOSShell}
 SetMemTop(HeapEnd);{Забираем ее обратно}

&gt;$0004
А знаете  ли вы (по-моему,  этого не знает даже Питер Нор-
тон), что запуская из вашей программы DOSShell вы вполне можете
оставить в  Environment  достаточно свободного места для работы
сложных BAT-файлов.  Решение  лежит на поверхности: Пусть пере-
менная  EnvSize:Integer  содержит размер  корневого Environment
(откуда вы его  возьмете - ваше дело. Можно воспользоваться мо-
дулем TPEnv из  архива  BONUS в TurboProfessional, можно просто
задать    константу    побольше.    Далее   делаем   вот    так
Str(EnvSize,tmpString);
Exec(GetEnv('COMSPEC'),'/E:'+tmpString);
     Почему этого не сделал 