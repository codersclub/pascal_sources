<html><head><title>Особенности печати на LaserJet из среды BP</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<meta name="description" content='Исправления в Борландовсом модуле PRNFLTR для правильной печати русских букв на лазернике'>
<meta name="keywords" content="pascal, sources, source code, prnfltr, printing, Принтеры и Печать ">
<LINK REL=STYLESHEET TYPE="text/css" HREF="../sources.css"></head><BODY><center>

<!--#include virtual="/t_hmenu.htm"-->


<div align='left'>&nbsp;&nbsp;&nbsp;<a class='title' href="index.htm">Принтеры и Печать</a>&nbsp&nbsp;&nbsp;&nbsp;<small>&gt;&gt;</small>&nbsp;&nbsp;&nbsp;&nbsp;prnfltr
<br>&nbsp;&nbsp;&nbsp;<img border=0 height=4 width=50% align='top' src="../img/b.gif" alt="">
<br>&nbsp;
</div>


<TABLE cellSpacing=0 cellpadding=0 width=97% border=0>

<TR class=subheader><TD colSpan=3><IMG height=2 src="../img/1x1.gif" width=1></td></tr>
<TR><TD class=subheader width=70% nowrap>&nbsp;Особенности печати на LaserJet из среды BP</TD>
<TD nowrap class=black>&nbsp;<img border=0 align=bottom src="../img/mail.gif">&nbsp;<a href="mailto:vitus@fe.msk.ru">Виктор Вагнер</a></TD>
<TD class=black align='right'>18.10.1996</TD></TR>
<TR vALign=top><TD class=black>&#10;<p style="margin-left:20px">Исправления в Борландовсом модуле PRNFLTR
для правильной печати русских букв на лазернике</TD><TD class=black colspan=2 align='right'><br><A HREF="prnfltr.zip"><img border=0 align=middle src="../img/dsk.gif"></A><br>1k&nbsp;</TD></TR><TR><TD>&nbsp;</TD></TR>

<TR class=subheader><TD colSpan=3><IMG height=2 src="../img/1x1.gif" width=1></td></tr>
<TR><TD colspan=3><PRE><p style="margin-left:50px">From: "Victor B. Wagner" &lt;vitus@agropc.msk.su&gt;
Subject: Печать на LaserJet с синтаксическими выделениями и русские буквы
Date: 18 Oct 1996 20:42:14 +0400


Может быть, кому-то приходилось сталкиваться с такой проблемой:
при печати на HP LaserJet из среды Borland Pascal пропадают
русские буквы в комментариях и текстовых константах и/или
в конце работы принтер выкидывает пустую страницу.

Мы у себя эту проблему решили следующим образом:

В исходном тексте PRNFLTR, который входит в дистрибутив BP 7.0
мы обнаружили
1) Команды смены шрифта, завязанные на Symbol Set.
2) В качестве строки деинициализации принтера на него передается
  chr(12) (FormFeed), который выкидывает страницу безотносительно
  к наличию данных в буфере.

Это лечится следующим образом:

Строки с 125 по 133 заменяются на:

  { HP LaserJet code definition }

  HPInit      = #27'E'#27'(3R'#27'(s0p10.00h12.0v0s0b3T';
  HPItalic    = #27'(3R'#27'(s0p10.00h12.0v1s0b3T';
  HPNoItalic  = #27'(3R'#27'(s0p10.00h12.0v0s0b3T';
  HPBold      = #27'(3R'#27'(s0p10.00h12.0v0s3b3T';
  HPNoBold    = #27'(3R'#27'(s0p10.00h12.0v0s0b3T';
  HPULine     = #27'&dD';
  HPNoULine   = #27'&d@';

Эти команды тоже завязаны на набор символов, но используют русские шрифты
из SIMM для HP LaserJet4p (если кто знает набор команд не меняющий текущего
шрифта, и работающий независимо от русификации - поправьте меня)

строка 162 (определение Postamble в константе LaserJetCodes)
заменяется на:
    Postamble: #27'%-12345X'#27'E'#27'%-12345'

Вот в этой конструкции я уверен абсолютно (кстати, в Preamble, точнее
HPInit борландовцы поставили ту же самую ESC E).


---------------------------------------------------------------------------
Phone: 7(095)230-80-61                          Victor B. Wagner
Fax:   7(095)230-80-42                          Dokuchaev Soil Institute
EMail: vitus@agropc.msk.su                      Pyzhevsky lane, 7
                                                Moscow,109017 Russia</PRE>

<!--#include virtual="/t_footer.htm"-->
