<html><head><title>Fit a Straight Line through n Points</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<meta name="description" content='Тривиальная реализация линейной регрессии методом наименьших квадратов (МНК). Берет на вход два массива координат X и Y, массив, в который будут помещены вычисленные Y (y_calc), две переменные, в которые будут помещены коэффициенты прямой (a, b), число пар точек, переменные, в которые будут помещены коэффициент корреляции и стандартные отклонения для x и y (correl, sigma_a, sigma_b).'>
<meta name="keywords" content="pascal, sources, source code, linfit, math, Математика ">
<LINK REL=STYLESHEET TYPE="text/css" HREF="../sources.css"></head><BODY><center>

<!--#include virtual="/t_hmenu.htm"-->


<div align='left'>&nbsp;&nbsp;&nbsp;<a class='title' href="index.htm">Математика</a>&nbsp&nbsp;&nbsp;&nbsp;<small>&gt;&gt;</small>&nbsp;&nbsp;&nbsp;&nbsp;linfit
<br>&nbsp;&nbsp;&nbsp;<img border=0 height=4 width=50% align='top' src="../img/b.gif" alt="">
<br>&nbsp;
</div>


<TABLE cellSpacing=0 cellpadding=0 width=97% border=0>

<TR class=subheader><TD colSpan=3><IMG height=2 src="../img/1x1.gif" width=1></td></tr>
<TR><TD class=subheader width=70% nowrap>&nbsp;Fit a Straight Line through n Points</TD>
<TD nowrap class=black>&nbsp;<img border=0 align=bottom src="../img/mail.gif">&nbsp;<a href="mailto:murph@acdlabs.ru">murph</a></TD>
<TD class=black align='right'>28.02.2001</TD></TR>
<TR vALign=top><TD class=black>&#10;<p style="margin-left:20px">Тривиальная реализация линейной регрессии методом наименьших квадратов (МНК).
Берет на вход два массива координат X и Y,
массив, в который будут помещены вычисленные Y (y_calc),
две переменные, в которые будут помещены коэффициенты прямой (a, b),
число пар точек, переменные, в которые будут помещены коэффициент
корреляции и стандартные отклонения для x и y (correl, sigma_a, sigma_b).</TD><TD class=black colspan=2 align='right'><br><A HREF="linfit.zip"><img border=0 align=middle src="../img/dsk.gif"></A><br>2k&nbsp;</TD></TR><TR><TD>&nbsp;</TD></TR>

<TR class=subheader><TD colSpan=3><IMG height=2 src="../img/1x1.gif" width=1></td></tr>
<TR><TD colspan=3><PRE><p style="margin-left:50px">{ downloaded from some algorithm collection}
{159} {update -&gt;} {166}  {update -&gt;} {ХБЗ}
{ modified by murph 28.02.2001 }
{Тривиальная реализация линейной регрессии методом наименьших
квадратов (МНК).
Берет на вход два массива координат X и Y,
массив, в который будут помещены вычисленные Y (y_calc),
две переменные, в которые будут помещены коэффициенты
прямой (a, b), число пар точек, переменные, в которые
будут помещены коэффициент корреляции и стандартные
отклонения для x и y (correl, sigma_a, sigma_b).
Вот так. Вот код покрасивше:
}
procedure linfit(x,y: array of real;
   var y_calc: array of real;
   var a,b:    real;
   n:   integer;
   var correl: real;Var sigma_a: real;var sigma_b:real);
{ fit a straight line (y_calc) through n sets of
  x and y pairs of points }

var i  : integer;

 sum_x,sum_y,sum_xy,sum_x2,
 sum_y2,xi,yi,sxy,syy,
 sxx  : real;
 see:real;

begin   { linfit }
  sum_x:=0.0;
  sum_y:=0.0;
  sum_xy:=0.0;
  sum_x2:=0.0;
  sum_y2:=0.0;
  for i:=1 to n do
  begin
    xi:=x[i];
    yi:=y[i];
    sum_x:=sum_x+xi;
    sum_y:=sum_y+yi;
    sum_xy:=sum_xy+xi*yi;
    sum_x2:=sum_x2+xi*xi;
    sum_y2:=sum_y2+yi*yi;
  end;
  sxx:=sum_x2-sum_x*sum_x/n;
  sxy:=sum_xy-sum_x*sum_y/n;
  syy:=sum_y2-sum_y*sum_y/n;
  b:=sxy/sxx;
  a:=((sum_x2*sum_y-sum_x*sum_xy)/n)/sxx;
  correl:=sxy/sqrt(sxx*syy);
  see:=sqrt((sum_y2-a*sum_y-b*sum_xy)/(n-2));
  sigma_b:=see/sqrt(sxx);
  sigma_a:=sigma_b*sqrt(sum_x2/n);
  for i:=1 to n do
    y_calc[i]:=a+b*x[i]

end;  { LINFIT }</PRE>

<!--#include virtual="/t_footer.htm"-->
