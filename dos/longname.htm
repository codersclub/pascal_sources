<html><head><title>DOS session LONG-FILENAME functions for BP7</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<meta name="description" content='Модуль для работы с длинными именами файлов в DOS сессии под Windows95/NT.'>
<meta name="keywords" content="pascal, sources, source code, longname, dos, Окружение OS ">
<LINK REL=STYLESHEET TYPE="text/css" HREF="../sources.css"></head><BODY><center>

<!--#include virtual="/t_hmenu.htm"-->


<div align='left'>&nbsp;&nbsp;&nbsp;<a class='title' href="index.htm">Окружение OS</a>&nbsp&nbsp;&nbsp;&nbsp;<small>&gt;&gt;</small>&nbsp;&nbsp;&nbsp;&nbsp;longname
<br>&nbsp;&nbsp;&nbsp;<img border=0 height=4 width=50% align='top' src="../img/b.gif" alt="">
<br>&nbsp;
</div>


<TABLE cellSpacing=0 cellpadding=0 width=97% border=0>

<TR class=subheader><TD colSpan=3><IMG height=2 src="../img/1x1.gif" width=1></td></tr>
<TR><TD class=subheader width=70% nowrap>&nbsp;DOS session LONG-FILENAME functions for BP7</TD>
<TD nowrap class=black>&nbsp;<img border=0 align=bottom src="../img/mail.gif">&nbsp;<a href="mailto:mahatma@ped.belpak.minsk.by">Denis Kaganovich</a></TD>
<TD class=black align='right'>09.09.1996</TD></TR>
<TR vALign=top><TD class=black>&#10;<p style="margin-left:20px">Модуль для работы с длинными именами файлов
в DOS сессии под Windows95/NT.</TD><TD class=black colspan=2 align='right'><br><A HREF="longname.zip"><img border=0 align=middle src="../img/dsk.gif"></A><br>2k&nbsp;</TD></TR><TR><TD>&nbsp;</TD></TR>

<TR class=subheader><TD colSpan=3><IMG height=2 src="../img/1x1.gif" width=1></td></tr>
<TR><TD colspan=3><PRE><p style="margin-left:50px">(***********************************************************************)
(*   DOS session Windows95/NT LONG-FILENAME functions unit for BP 7    *)
(*                                                                     *)
(*                             (c) Denis Kaganovich, Minsk, 06.09.1996 *)
(*                             E-mail: mahatma@ped.belpak.minsk.by     *)
(*                                     mahatma@aete.belpak.minsk.by    *)
(*                                     2:450/39.242@fidonet            *)
(*                                                                     *)
(* Based on information from Ralf Braun's INTERLIST v4.6               *)
(*                                                                     *)
(* Minimal needed realisation:                                         *)
(*  - SHORT&lt;-&gt;LONG names transformation                                *)
(*  - long-filename Move/Rename                                        *)
(*  - volume info (maximum size of name/path, type of file system)     *)
(* Additional:                                                         *)
(*  - Win95 FindFirst/FindNext/FindClose (may be faster)               *)
(* Win95/DOS session supports more long-filename functions, but that   *)
(* not needed.                                                         *)
(* Tested - working in real & protected modes                          *)
(***********************************************************************)
procedure LFNGetName(SubFn:word; Src,Dst:PChar);
procedure LFNRename(NameFrom,NameTo:PChar);
procedure LFNGetVolInfo(RootName,Buf:PChar; BufSize:word;
          var Flags,NameSize,PathSize);
{================ Standard pascal STRING versions: ===================}
{!!!WARNING! MAY BE BUGS - "STRING" SIZE=255 BUT LONG NAME UP TO 261! }

function sLFNGetName(SubFn:word; Src:string):string;
procedure sLFNRename(NameFrom,NameTo:string);
function sLFNGetVolInfo(RootName:string; var Flags,NameSize,PathSize):
                                                               string;
function LFNFindFirst(Path:PChar; Attr:word; var S:TLFNSearchRec):word;
procedure LFNFindNext(Handle:word; var S:TLFNSearchRec);
procedure LFNFindClose(Handle:word);</PRE>

<!--#include virtual="/t_footer.htm"-->
