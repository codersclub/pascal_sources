<html><head><title>Шпион прерываний</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<meta name="description" content='Программа остается резидентной в памяти, шпионит за исользованием указанного прерывания из указанной программы, при активизации записывает на диск протокол использования прерывания'>
<meta name="keywords" content="pascal, sources, source code, intspy, tsr, Резидентные Программы ">
<LINK REL=STYLESHEET TYPE="text/css" HREF="../sources.css"></head><BODY><center>

<!--#include virtual="/t_hmenu.htm"-->


<div align='left'>&nbsp;&nbsp;&nbsp;<a class='title' href="index.htm">Резидентные Программы</a>&nbsp&nbsp;&nbsp;&nbsp;<small>&gt;&gt;</small>&nbsp;&nbsp;&nbsp;&nbsp;intspy
<br>&nbsp;&nbsp;&nbsp;<img border=0 height=4 width=50% align='top' src="../img/b.gif" alt="">
<br>&nbsp;
</div>


<TABLE cellSpacing=0 cellpadding=0 width=97% border=0>

<TR class=subheader><TD colSpan=3><IMG height=2 src="../img/1x1.gif" width=1></td></tr>
<TR><TD class=subheader width=70% nowrap>&nbsp;Шпион прерываний</TD>
<TD nowrap class=black>&nbsp;<img border=0 align=bottom src="../img/mail.gif">&nbsp;<a href="mailto:nick@ormix.riga.lv">Николай Вальтер</a></TD>
<TD class=black align='right'>06.12.1993</TD></TR>
<TR vALign=top><TD class=black>&#10;<p style="margin-left:20px">Программа остается резидентной в памяти,
шпионит за исользованием указанного прерывания из указанной программы,
при активизации записывает на диск протокол использования прерывания</TD><TD class=black colspan=2 align='right'><br><A HREF="intspy.zip"><img border=0 align=middle src="../img/dsk.gif"></A><br>5k&nbsp;</TD></TR><TR><TD>&nbsp;</TD></TR>

<TR class=subheader><TD colSpan=3><IMG height=2 src="../img/1x1.gif" width=1></td></tr>
<TR><TD colspan=3><PRE><p style="margin-left:50px">From: Nick Walter &lt;nick@ormix.riga.lv&gt;
Subject: Исходник Одной Интересной Резидентной Программы
Organization: ORMIX Ltd

     В последнее время все чаще стали появлятся "коммерческие" .TPU модули.
Често признаюсь, что меня не интересовал Turbo Vision, пока у меня не
появился RTL. Редко бывает, что в библиотеке, автор предусмотрел все, что
может заинтересовать того кто эту библиотеку использует. В Turbo Vision мне
не нравилось очень многое и по этому он меня не интересовал до тех пор, пока
у меня не появилась возможность его модифицировать.

     В противоположенность "коммерческим" .TPU предлагаю исходный текст одной
очень интересной програмульки.

     Я предполагаю, что у Вы знаете ассемблер .86 т.к. 90% исходника -
ассемблер.

     Как известно сделать резидентную программу которая после активизации
пользуется досовскими прерываниями дело непростое :-| (1000 и 1 перезапуск по
зависанию).

     Тем кого интересует КАК это сделать я и адресую свою програмульку.  Хотя
я думаю она будет интересна и сама по себе как программа.

     Программулька остается резидентной в памяти, шпионит за исользованием
указанного прерывания из указанной программы, при активизации записывает на
диск протокол использования прерывания:

  1) адрес памяти откуда было вызвано прерывание
  2) содержимое регистров

     Выкидывает себя из памяти ( если это возможно ) при нажатии определенной
комбинации клавиш. Если удастся выкинуть TSR во время работы какой-нибудь
Pascal-праграммы, то по выходу из этой Pascal-программы скорее всего
произойдет зависание (недостаток инициализационного кода Turbo Pascal).

Тем кого моя программа заинтересует и кто захочет продолжения этой темы:

     Могу предложить исходник более мощной TSR-программы, которая независимо
от своих паскалевских размеров (CODE,DATA,STACK,OVERLAY,HEAP), причем
реальный размер программы вычисляется автоматически, будет занимать в памяти
около 3K(!). Естественно это достигается путем своппинга. По желанию
пользователя своппинг производится либо в Extended (Expanded) Memory либо на
диск. Предусмотрено удаление программы из памя