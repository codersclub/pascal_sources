<html><head><title>Паскаль по фамилии Борланд - Статьи о Паскале - Pascal.Sources.Ru</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<meta name="description" content='Как заставить программы Turbo Pascal 7.0 работать на быстрых компьютерах. О том, как победить пресловутую ошибку Error 200 - division by zero.'>
<meta name="keywords" content='pascal, sources, source code, article, Как заставить программы Turbo Pascal 7.0 работать на быстрых компьютерах. О том, как победить пресловутую ошибку Error 200 - division by zero'>
<LINK REL=STYLESHEET TYPE="text/css" HREF="../sources.css"></head><BODY><center>
<!--#include virtual="/t_hmenu.htm"-->
<div align='left'>&nbsp;&nbsp;&nbsp;<a class='title' href="index.htm">Статьи о Паскале</a>&nbsp&nbsp;&nbsp;&nbsp;<small>&gt;&gt;</small>&nbsp;&nbsp;&nbsp;&nbsp;Паскаль по фамилии Борланд
<br>&nbsp;&nbsp;&nbsp;<img border=0 height=4 width=60% align='top' src="../img/b.gif" alt="">
<br>&nbsp;
</div>
<TABLE cellSpacing=0 cellpadding=0 width=97% border=0>
<TR class=subheader><TD colSpan=3><IMG height=2 src="../img/1x1.gif" width=1></td></tr>
<TR><TD class=subheader width=70% nowrap>&nbsp;Паскаль по фамилии Борланд
</TD><TD nowrap class=black>&nbsp;&nbsp;
Михаил Проломов
</TD>
<TD class=black align='right'>31.01.2001</TD></TR>
<TR vALign=top><TD class=black><p style="margin-left:20px">
<br>Как заставить программы Turbo Pascal 7.0 работать на быстрых компьютерах. О том, как победить пресловутую ошибку Error 200 - division by zero. 
</TD><TD class=black colspan=2 align='right'><img border=0 align=middle src="../img/more.gif">
<br>9k&nbsp;</TD></TR><TR><TD>&nbsp;</TD></TR>
<TR class=subheader><TD colSpan=3><IMG height=2 src="../img/1x1.gif" width=1></td></tr>
<TR><TD colspan=3>
<div style="margin-left:50px">

<a href="http://www.softerra.ru/review/program/6928/">СофтТерра</a>
<hr size=1 noshade>
<h2>Паскаль по фамилии Борланд</h2>
<p>Как заставить программы Turbo Pascal 7.0 работать на быстрых компьютерах.</p>
<p><a href=mailto:submitit2me@mail.ru>Михаил Проломов</a></p>
<p>31.01.2001</p>

<P>Как показали отклики по поводу первой статьи из серии о Turbo Pascal, данная тема действительно ничуть себя не изжила.</P>
<P>Первая благодарность – тем, кто написал мне лично и в редакцию, тем более, что письма были написаны действительно со знанием темы. О присланных программах на Паскале я скоро расскажу в отдельной статье, а сегодня обсудим программу CrtDebug, которая позволяет программам, откомпилированным на TP 7.0, работать на быстрых компьютерах. </P>
<P>Программу CrtDebug прислал мне читатель СофтТерры Василий Ханефт, скачать ее можно <A target=_blank href="http://pq.ozersk.ru/ftp/FIDO/CRACKER/CRT.RAR">здесь</A>, а e-mail ее автора Валерьяна Ивашенко из Минска - <A href="mailto:iVA99@xoommail.com">iVA99@xoommail.com</A>.</P>
<P>CRTDebug предназначена для корректировки exe-файлов, созданных с помощью Borland Pascal 7.0. При исполнении на быстрых процессорах из-за некорректного кода CRT модуля происходит ошибка: 200 Division by zero. </P>
<P>Модуль CRT содержит такие подчас необходимые функции, как управление выводом на дисплей, позиционирование курсора, работа с цветом текста, подача звуковых сигналов, использование таймера. Многие программы при переносе на быстрые ПК выдают ошибку 200 Division by zero и оставляют пользователя в недоумении.</P>
<P>Ранее я советовал использовать Turbo Pascal 6.0, эта версия не дает подобной ошибки. Но с ней неудобно работать из-под Windows: под Windows 98 Turbo Pascal 6.0 не может работать совместно с другими программами, компьютер целиком переводится в режим эмуляции MS-DOS.</P>
<P>После появления у меня программы CrtDebug, Turbo (Borland) Pascal 7.0 действительно заработал. Плюсом этого компилятора является не только возможность не мешать многозадачности Windows, но и более продуманный интерфейс с большим количеством установок, “раскраской” операторов и возможностью компилировать программы для работы в защищенном режиме. Также Borland Pascal 7.0 способен компилировать программы под Windows и имеет ряд функций, не включенных в шестую версию. Но в настоящее время для программирования под Windows используются, как правило, другие программы, поэтому для нас основные положительные стороны Borland Pascal 7.0 – "раскраска" операторов и работа в многозадачных ОС.</P>
<P>Пользоваться программой CrtDebug очень просто. Чтобы восстановить работоспособность программ, откомпилированных в Borland Pascal 7.0, необходимо запустить CRTDebug: </P>
<P><PRE>CRTDebug filename.ext &lt;число&gt;</PRE>
<P></P>
<P>Здесь filename.ext - имя файла, который вы хотите исправить, а &lt;число&gt; - параметр, значением которого может быть любое целое число в диапазоне от 55 до 65535. </P>
<P>Желательно, чтобы исправляемый файл не был упакован упаковщиками exe-файлов - в противном случае файл скорее всего не будет исправлен. </P>
<P>Главное же – исправить файлы turbo.tpl и tpp.tpl. Для этого выполните:</P>
<P><PRE>CRTDebug turbo.tpl &lt;число&gt;
CRTDebug tpp.tpl &lt;число&gt;</PRE>
<P></P>
<P>После этого вы сможете использовать ваш BP 7.0 при компиляции программ на машине с быстрым процессором. </P>
<P>Параметр &lt;число&gt; является необязательным, лично я его не указывал и получил вполне удовлетворительный результат. Если вы не находите файла tpp.tpl, не переживайте:я его тоже не нашел, однако все работает нормально:).</P>
<P>В качестве примечания автор CrtDebug предостерегает: если в ваших файлах используется паскалевская процедура CRT.Delay, то нет гарантии, что программа будет работать корректно. В этом случае попробуйте поизменять значение параметра &lt;число&gt;. Если это не поможет, то файл можно вернуть в исходное состояние таким образом: </P>
<P><PRE>CRTDebug filename.ext 55</PRE>
<P></P>
<P>Если же вы скорректировали BP-библиотеки turbo.tpl и tpp.tpl и не использовали при этом числовой параметр, то в процедуру Delay необходимо подставлять значение в десятитысячных долях секунды. От себя добавлю, что значение Delay изначально указывалось в миллисекундах, то есть тысячных долях секунды. </P>
<P>Напоследок для интересующихся объясню, почему, собственно, в модуле crt возникает такая загадочная ошибка. Как известно, процедура delay является частью модуля и используется как простейший ничего не делающий цикл, позволяющий задержать выполнение программы. Процедура delay инициализируется, даже если она и не применяется в программе. </P>
<P>При инициализации модуля crt программа выясняет, сколько итераций пустого цикла необходимо осуществить, чтобы остановить программу на 55 миллисекунд. Полученный результат записывается в 16-битную переменную. На быстрых ПК это число оказывается более 65535, и ячейка переполняется, вызывая ошибку, которую Borland Pascal определяет как 200 Division by zero ("Деление на ноль"). </P>
<P>Более подробную информацию на английском и другой вариант патча вы найдете на <A target=_blank href="http://www.brain.uni-freiburg.de/~klaus/pascal/runerr200">сайте</A> немецкого товарища Клауса Хартнегга. Кстати, там предлагается несколько различных вариантов решения данной проблемы. Также рекомендую <A target=_blank href="http://faqs.org.ru/progr/pascal/pascal.htm">FAQ</A> по Паскалю (на русском).</P>
<br>
<hr size=1 noshade>
<a href="http://www.softerra.ru/review/program/6928/">СофтТерра</a>
<br>
<br>


</DIV>
<!--#include virtual="/t_footer.htm"-->
