<html><head><title>Прогулки со шляпой - Статьи о Паскале - Pascal.Sources.Ru</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<meta name="description" content='Простейшая программа для изображения трехмерной поверхности, внешне напоминающей шляпу... BGI graphics.'>
<meta name="keywords" content='pascal, sources, source code, article, Простейшая программа для изображения трехмерной поверхности, внешне напоминающей шляпу... BGI graphics'>
<LINK REL=STYLESHEET TYPE="text/css" HREF="../sources.css"></head><BODY><center>
<!--#include virtual="/t_hmenu.htm"-->
<div align='left'>&nbsp;&nbsp;&nbsp;<a class='title' href="index.htm">Статьи о Паскале</a>&nbsp&nbsp;&nbsp;&nbsp;<small>&gt;&gt;</small>&nbsp;&nbsp;&nbsp;&nbsp;Прогулки со шляпой
<br>&nbsp;&nbsp;&nbsp;<img border=0 height=4 width=60% align='top' src="../img/b.gif" alt="">
<br>&nbsp;
</div>
<TABLE cellSpacing=0 cellpadding=0 width=97% border=0>
<TR class=subheader><TD colSpan=3><IMG height=2 src="../img/1x1.gif" width=1></td></tr>
<TR><TD class=subheader width=70% nowrap>&nbsp;Прогулки со шляпой
</TD><TD nowrap class=black>&nbsp;&nbsp;
Евгений Скляревский
</TD>
<TD class=black align='right'>30.01.2001</TD></TR>
<TR vALign=top><TD class=black><p style="margin-left:20px">
<br><img border=0 width=60 height=45 vspace=4 hspace=8 align="left" alt="" src="6886.gif">
Простейшая программа для изображения трехмерной поверхности, внешне напоминающей шляпу... BGI graphics. 
</TD><TD class=black colspan=2 align='right'><img border=0 align=middle src="../img/more.gif">
<br>26k&nbsp;</TD></TR><TR><TD>&nbsp;</TD></TR>
<TR class=subheader><TD colSpan=3><IMG height=2 src="../img/1x1.gif" width=1></td></tr>
<TR><TD colspan=3>
<div style="margin-left:50px">

<A HREF="http://www.homepc.ru/online/homeprog/6886/">Домашний Компьютер</a>
<hr size=1 noshade>

<h2>Прогулки со шляпой</h2>
<a href=mailto:evgenij@aport.ru>Евгений Скляревский</a>
<br>30.01.2001
<br>
<br>
<P>Прежде чем пояснить, при чём тут шляпа, определимся - кому это интересно. А интересно это многим счастливчикам, познавшим кайф нажимания клавиш на ПК, полётов на Turbo Pascal’е в мир узоров, поверхностей и всякой волшебной математической чепухи. Тут уж точно мир раскололся на две половины и вторая, б<B><I>о</B></I>льшая, глядя на экран, спрашивает: “Ну и что? Какая от этого польза?”</P>
<P>- “Ну и ничего, пользы действительно никакой ...” Но и прекратить невозможно, всё время толкает: “А что если удвоить, зациклить, округлить, отразить ...”.</P>
<P>Так вот, всё вышесказанное имеет весьма приблизительное отношение к основной теме (и к другим тоже ) Давным-давно попалась мне на глаза красивая функция:</P>
<pre>
		       Sin(X<SUP>2</SUP>+Y<SUP>2</SUP>)
		Z = ----------------
		         X<SUP>2</SUP>+Y<SUP>2</SUP>
</pre>

<P>Полюбуемся ею вместе:</P>
<ul>
<li>трёхмерная поверхность</li>
<li>синус должен дать “волны”</li>
<li>должна быть некоторая “горбушка”</li>
<li>убывает при удалении от начала координат каким-то образом</li>
<li>симметрия относительно осей </li>
</ul>

<P>Так и просится пощупать её на экране. А вот и вариант исполнения задумки:</P>
<P></P>
<pre>
PROGRAM SHLAPA;
USES GRAPH,DOS,CRT;
VAR
  GraphDriver, GraphMode, ErrorCode,X,X1,Y,Y1 : INTEGER;
  Q,W: REAL;
  U,Z:REAL;
  C: CHAR;
BEGIN
  GraphDriver:= Detect;
  InitGraph(GraphDriver,GraphMode,'');
  X1:=0 ; Y1:=0 ; Q:=-15;
  REPEAT
    W:=-10;
    REPEAT
      U:=0.29*Q*Q+0.29*W*W; {1}
      Z:=(5*SIN(U))/ U+5.3; {2}
      X:=TRUNC(300+27*(Q-W*COS(PI/4))); {3}
      Y:=TRUNC(350+27*(W*SIN(PI/4)-Z)); {4}
      IF W &gt; -10 THEN LINE(X,Y,X1,Y1); {5}
      X1:=X ; Y1:=Y;
      W:=W+0.05 ;
      SETCOLOR(TRUNC(Z*7+7)); {6}
    UNTIL W&gt;13 ;
    Q:=Q+0.05 ;
  UNTIL Q&gt;18;
  C:=READKEY;
END.
</PRE>
<P></P>
<P>Так вот: это и есть та самая шляпа с полями, вынесенная в заголовок.</p>
<center><img border=0 width=350 height=263 alt="Вы просили шляпу?" src="68861.jpg"></center>
<p>Причём на экран она выходит в аксонометрии, а угол наклона локальных осей шляпы относительно экранных можно попробовать поменять в строках {3} и {4} . Самые отчаянные могут попробовать разные значения углов для проекций на <B>X</B> и на <B>Y</B>, но от такой наглости трудно ожидать прогнозируемый результат. Гораздо интереснее поиграть коэффициентами:</P>
<P>
<PRE>
     A * Sin( U )
Z = --------------      где <B>U = C * X2 + D * Y2 + E * X * Y</B>
        U + B
</PRE></p>
<P><b>A</B> - делает шляпу острее или положе</P>
<P><b>B</B> - ещё и сдвигает её вдоль оси <B>Z</b></P>
<P><b>C</B> и <B>D</B> - сжимают шляпу вдоль осей <B>X, Y</b></P>
<P><b>E</B> - сжимает шляпу вдоль оси, проходящей под углом 45 градусов к осям <B>XY</B></P>
<P>Для тех у кого две макушки, интересна замена: <B>U = ( X - F ) * (X + F ) + Y2</B> . В результате шляпа раздваивается, разъезжается по оси <B>X</B> на величину <B>2*F</B>. Аналогично можно раздвинуть шляпу и по <B>Y:</B></P>
<P><B>U = ( X - F ) * ( X + F ) + ( Y - G ) * ( Y + G )</B>, получив четырёх холмистую шляпу для рогатых мутантов.</P>
<P>Можно ещё поменять знак: <B>U = X2 - Y2</B>, превратив шляпу в нечто гиперболическое, на шляпу не похожее, в обиходе не встречающееся.</P>
<P>Шляпа рисуется ломаными линиями, с параметрами <B>Q</B> и <B>W</B> (локальными осями <B>X</B> и <B>Y</B> шляпы). Плавность линий зависит от величины приращений <B>W</B>, а частота линий от величины приращений <B>Q</B>. Чем меньше эти величины приращений, тем ярче шляпа, но дольше рисуется. Так что на Pentium’e можно получить шляпу поярче, а на 286-м - пореже.</P>
<P>А вы оценили раскраску шляпы? Цвет зависит от величины <B>Z</B>, меняя параметры можно получать пояски на тулье и на полях и даже волнистую шахматную доску.</P>
<P>Для самых занудных и въедливых читателей, ещё продолжающих читать этот бред, предлагаю попробовать поменять <B>Sin(U)</B> на <B>Sin<sup>2</sup>(U)</B>, на <B>Cos(U)</B>, на <B>Sin(2*U)</B> и вы будете вознаграждены открывшимися пейзажами - вокруг островка шляпы вдруг появляются лунные кратеры от гармоник высших порядков, объяснить которые с точки зрения тригонометрии и материализма невозможно.</P>
<P>А ещё можно попробовать поменять… но не буду лишать вас удовольствия самим поиграть и насладиться своим результатом. Шляпа хранит много приятных мгновений общения с ПК, достаньте их из неё.</P>
<P></P>
<P><B>P.S</B>. И всё-таки невозможно удержаться: нарисуйте шляпу в полярных координатах - не пожалеете. А если центр этих координат не совпадает с центром шляпы . . .
<br>Всё - ухожу, ухожу.</P>
<hr size=1 noshade>
<A HREF="http://www.homepc.ru/online/homeprog/6886/">Домашний Компьютер</a>
<br>
<br>



</DIV>
<!--#include virtual="/t_footer.htm"-->
